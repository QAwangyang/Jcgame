{% extends "base.html" %}


{% block tittle %}

  <title>Jcgame | 图说</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="format-detection" content="telephone=no">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-siteapp"/>

{% endblock %}


{% block mainbody %}

  <div class="am-u-md-8">
  {% for list in newslist %}
        <article class="blog-main">
          <h3 class="am-article-title blog-title">
            <a href="#">{{list.1}} </a>
          </h3>
          <h4 class="am-article-meta blog-meta"> posted on {{list.4}} by wangyang thanks <a href="http://baike.baidu.com">百度百科</a></h4>

          <div class="am-g blog-content">
            <div class="am-u-lg-7">  <!-- 关闭转义 -->
            {% autoescape off %}   
              {{list.2}}
            {% endautoescape %}
            </div>
            <div class="am-u-lg-5">
              <p><img src='{{MEDIA_URL}}{{list.3}}' ></p>
            </div>
          </div>
        </article>
  {%endfor%}

<!--     <hr class="am-article-divider blog-hr">
    <hr class="am-article-divider blog-hr">
    <ul class="am-pagination blog-pagination">
      <li class="am-pagination-next"><a href="http://cars.jcgame.net">下一页 &raquo;</a></li>
    </ul> -->
  </div>


<script>
    var page_num =0
    var slow = true
    $(window).scroll(function() {
        if ($(document).scrollTop() >= $(document).height() - $(window).height()) {   //判断是否已经滚动到页面底部；
            page_num+=1
            console.log("come input")
            //$("#loading").css("display", "block");                                                            //切换正在加载的数据的图片状态为显示；
            jQuery.ajax({
            type:"POST",
            url:"/blog/get_more_news",
            async:true,
            dataType:"json",
            data:{"page_num":page_num},                                                                                
                success: function(data) {                                                                         
                    var str = ""                                                                                         
                    $.each(data, function(i, item) {
                      console.log(item.date)
                             str += "<article class='blog-main'>"
                             str += "<h3 class='am-article-title blog-title'>"
                             str += "<a href='#''>"+item.title+"</a>"
                             str += "</h3>"
                             str +="<h4 class='am-article-meta blog-meta'> posted on " + item.date +" by wangyang thanks <a href='http://baike.baidu.com'>百度百科</a></h4>"
                            str += "<div class='am-g blog-content'><div class='am-u-lg-7'> {% autoescape off %}"+item.body+"{% endautoescape %}</div>"
                            str +="<div class='am-u-lg-5'><p><img src='{{MEDIA_URL}}'"+item.pic_name+" ></p></div></div></article>"    
                    });
                    $(".am-u-md-8").append(str);

                    if (slow==true){
                      if(data.length<=5){
                        slow=false
                        var strlow = "" 
                      strlow+="<hr class='am-article-divider blog-hr'><hr class='am-article-divider blog-hr'><ul class='am-pagination blog-pagination'>"
                      strlow+="<li class='am-pagination-next'><a href='http://cars.jcgame.net'>模拟摇号 &raquo;</a></li></ul>"
                    $(".am-u-md-8").append(strlow);
                    }   
                    }                                          
                }
            });
        }
    });        
</script>
{% endblock %}





